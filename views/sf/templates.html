<!-- StrikeFinder View Templates -->

<script type="text/template" id="ioc-details-template">
    <div class="uac-header">
        <i class="icon-list"></i> <span class="uac-header"><%= legend %></span>
    </div>

    <hr style="margin-top: 5px"/>

    <% _.each( items, function( item, index ) { %>

    <h4><%= item.iocuuid %></h4>

    <table id="uuid-<%= index %>-table"
           class="table table-striped table-bordered table-hover table-condensed"
           style="margin-bottom: 15px">
    </table>
    <% }) %>
</script>

<script type="text/template" id="ioc-tabs-template">
    <ul class="nav nav-tabs" id="ioc-tabs" style="margin-bottom: 0px">
        <% _.each( items, function( item, index ) { %>
        <li>
            <a name="<%= item.exp_key %>" href="#ioc-tab-<%= index %>" data-toggle="tab">
                <span style="font-weight: bold"><%= item.name %></span>
            </a>
        </li>
        <% }) %>
    </ul>

    <div class="tab-content" style="border: 1px solid #dddddd; border-top: 0px">
        <% _.each( items, function( item, index ) { %>
        <div id="ioc-tab-<%= index %>"
             class="tab-pane <%= get_active_class(index) %>">
            <pre>
                <%- item.content %>
            </pre>

            <div id="suppressions-table-div" style="margin: 10px">
                <!-- Suppressions View Template -->
                <table id="<%= item.exp_key %>"
                       class="table table-striped table-bordered table-condensed suppressions-table">
                </table>
            </div>
        </div>
        <% }) %>
    </div>
</script>

<script type="text/template" id="audit-context-menu-template">
    <ul class="dropdown-menu" role="menu" style="display: block">
        <% if (is_suppress) { %>
        <li>
            <a id="suppress-item" tabindex="-1">
                <icon class="icon-level-down"></icon>
                Suppress...
            </a>
        </li>
        <li>
            <a id="auto-suppress-item" style="display: none" tabindex="-1">
                <icon class="icon-level-down"></icon>
                Auto-Suppress <span id="ioc-term-item"/>
            </a>
        </li>
        <% } %>
        <% if (is_acquire) { %>
        <li>
            <a id="acquire-item" tabindex="-1">
                <icon class="icon-cloud-download"></icon>
                Acquire...
            </a>
        </li>
        <% } %>
        <% if (is_masstag) { %>
        <li>
            <a id="tag-item" tabindex="-1">
                <icon class="icon-tags"></icon>
                Mass Tag...
            </a>
        </li>
        <% } %>
        <li class="divider"></li>
        <li>
            <a id="close-item" tabindex="-1">
                <icon class="icon-remove-sign"></icon>
                Close
            </a>
        </li>
    </ul>
</script>

<script type="text/template" id="suppression-form-template">
    <div id="suppression-form" class="modal hide fade" tabindex='-1'>
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
            <h3>
                <icon class="icon-level-down"></icon>
                Create Suppression
            </h3>
        </div>
        <div class="modal-body">
            <p>
                <label>Suppression Name:</label>
                <input id="comment" type="text" required="true" value="<%= itemvalue %>" style="width: 500px"/>

                <label>IOC:</label>
                <select id="exp_key" required="true" style="width: 400px">
                    <% _.each( iocs, function( ioc, index ) { %>
                    <% if (exp_key == ioc.exp_key) { %>
                    <option id="<%= ioc.exp_key %>" selected><%= ioc.name %> - <%= ioc.uuid %></option>
                    <% } else { %>
                    <option id="<%= ioc.exp_key %>"><%= ioc.name %> - <%= ioc.uuid %></option>
                    <% } %>
                    <% }) %>
                </select>

                <label>Term:</label>
                <select id="itemkey" required="true" style="width: 400px">
                    <option></option>
                    <% _.each( terms, function( item, index ) { %>
                    <% if (itemkey == item.text) { %>
                    <option id="<%= item.text %>" selected><%= item.title %></option>
                    <% } else { %>
                    <option id="<%= item.text %>"><%= item.title %></option>
                    <% } %>
                    <% }) %>
                </select>

                <label>Condition:</label>
                <select id="condition" required="true">
                    <option selected="true">contains</option>
                    <option>ends-with</option>
                    <option>greater-than</option>
                    <option>is</option>
                    <option>less-than</option>
                    <option>matches</option>
                    <option>starts-with</option>
                </select>

                <span>
                    <label>
                        <icon class="icon-file"></icon>
                        Suppression Text
                    </label>
                </span>
                <input id="itemvalue"
                       type="text"
                       value="<%= itemvalue %>"
                       required="true">

                <label class="checkbox" style="margin-top: 15px">
                    <input id="preservecase" type="checkbox" value=""/> Preserve Case
                </label>

                <label class="checkbox" style="margin-top: 15px">
                    <input id="global" type="checkbox" checked="true"/> Global
                </label>
            </p>
        </div>
        <div class="modal-footer">
            <a id="cancel" class="btn">
                <icon class="icon-remove-sign"></icon>
                Cancel
            </a>
            <a id="suppress" class="btn btn-primary">
                <icon class="icon-level-down"></icon>
                Suppress
            </a>
        </div>
    </div>
</script>

<script type="text/template" id="mass-tag-form-template">
    <div id="mass-tag-form" class="modal hide fade" tabindex='-1'>
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
            <h3>
                <icon class="icon-tags"></icon>
                Mass Tag
            </h3>
        </div>
        <div class="modal-body">
            <p>
                <label>Tag:</label>
                <select id="tagname" required="true">
                    <option></option>
                    <% _.each( tags, function( item, index ) { %>
                    <option id="<%= item.name %>" title="<%= item.description %>"><%= item.name %></option>
                    <% }) %>
                </select>

            <div style="margin-top: 15px; margin-bottom: 15px">
                <label class="radio">
                    <input type="radio" name="scope" id="cluster_uuid_option" value="cluster" checked> This Cluster
                </label>
                <label class="radio">
                    <input type="radio" name="scope" id="am_cert_hash_option" value="agent"> This Agent
                </label>
            </div>

            <label>IOC:</label>
            <select id="exp_key" required="true" style="width: 400px">
                <% _.each( iocs, function( ioc, index ) { %>
                <% if (exp_key == ioc.exp_key) { %>
                <option id="<%= ioc.exp_key %>" selected><%= ioc.name %> - <%= ioc.uuid %></option>
                <% } else { %>
                <option id="<%= ioc.exp_key %>"><%= ioc.name %> - <%= ioc.uuid %></option>
                <% } %>
                <% }) %>
            </select>

            <label>Term:</label>
            <select id="itemkey" required="true" style="width: 400px">
                <option></option>
                <% _.each( terms, function( item, index ) { %>
                <% if (itemkey == item.text) { %>
                <option id="<%= item.text %>" selected><%= item.title %></option>
                <% } else { %>
                <option id="<%= item.text %>"><%= item.title %></option>
                <% } %>
                <% }) %>
            </select>

            <label>Condition:</label>
            <select id="condition" required="true">
                <option selected="true">contains</option>
                <option>ends-with</option>
                <option>greater-than</option>
                <option>is</option>
                <option>less-than</option>
                <option>matches</option>
                <option>starts-with</option>
            </select>

                <span>
                    <label>
                        Value to Match:
                    </label>
                </span>
            <input id="itemvalue"
                   type="text"
                   value="<%= itemvalue %>"
                   required="true"
                   style="width: 500px">

            <label class="checkbox" style="margin-top: 15px">
                <input id="preservecase" type="checkbox" value=""/> Preserve Case
            </label>

            <label>Comment:</label>
            <textarea id="comment" style="width: 500px; height: 50px" required="true"></textarea>

            </p>
        </div>
        <div class="modal-footer">
            <a id="cancel" class="btn">
                <icon class="icon-remove-sign"></icon>
                Cancel
            </a>
            <a id="tag" class="btn btn-primary">
                <icon class="icon-tags"></icon>
                Add Tags
            </a>
        </div>
    </div>
</script>

<script type="text/template" id="acquire-form-template">
    <div id="acquire-form" class="modal hide fade" tabindex='-1'>
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
            <h3>
                <icon class="icon-cloud-download"></icon>
                Acquire File
            </h3>
        </div>
        <div class="modal-body">
            <p>
                <span>
                    <label>
                        <icon class="icon-file"></icon>
                        File Path
                    </label>
                </span>
                <input id="file_path"
                       type="text"
                       value="<%= file_path %>"
                       required="true"
                       style="width: 500px"/>

                <span>
                    <label>
                        <icon class="icon-file"></icon>
                        File Name
                    </label>
                </span>
                <input id="file_name"
                       type="text"
                       value="<%= file_name %>"
                       required="true"
                       style="width: 500px"/>

            <table id="acquire-form-formatting-table" style="width: 100%">
                <tr>
                    <td style="width: 50%">
                        <label>Method:</label>
                        <select id="method" required="true">
                            <option selected="true">raw</option>
                            <option>api</option>
                        </select>
                    </td>
                    <td>
                        <label class="checkbox" style="margin-top: 15px">
                            <input id="force" type="checkbox" value=""/> Force
                        </label>
                    </td>
                </tr>
            </table>

            <label>Comment:</label>
            <textarea id="comment" style="width: 500px; height: 50px"></textarea>

            <label>MCIC User for Cluster - <%= cluster_name %>:</label>
            <input id="user" type="text" required="true"/>

            <label>MCIC Password:</label>
            <input id="password" type="password" required="true"/>
            </p>
        </div>
        <div class="modal-footer">
            <a id="cancel" class="btn">
                <icon class="icon-remove-sign"></icon>
                Cancel
            </a>
            <a id="acquire" class="btn btn-primary">
                <icon class="icon-cloud-download"></icon>
                Acquire
            </a>
        </div>
    </div>
</script>

<script type="text/template" id="agent-host-template">
    <table id="agent-host-template-formatting-table" style="width: 100%">
        <tr>
            <td>
                <span class="uac-sub-header">
                    <%= cluster.engagement.client.name %> (<%= cluster.name %>) : <%= domain %> /
                    <a href="/sf/host/<%= hash %>/"><%= hostname %></a> /
                    <a href="/sf/host/<%= hash %>/"><%= ip %></a>
                </span>
            </td>
        </tr>
        <tr>
            <td>
                <%= product_name %> <%= os_patch_level %>
            </td>
        </tr>
        <tr>
            <td>
                <table id="agent-host-template-counts-formatting-table" style="width: 100%">
                    <tr>
                        <td>NotReviewed: <%= counts.notreviewed %></td>
                        <td>Investigating: <%= counts.investigating %></td>
                        <td>Escalate: <%= counts.escalate %></td>
                        <td>NotReported: <%= counts.unreported %></td>
                        <td>Reported: <%= counts.reported %></td>
                        <td>Delete: <%= counts.delete %></td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>
</script>

<script type="text/template" id="agent-host-empty-template">
    <h4 class="text-warning">No data found in Seasick.</h4>
    <code><%= am_cert_hash %></code>
</script>

<script type="text/template" id="agent-host-error-template">
    <h4 class="text-warning">Error obtaining host data, check Seasick status.</h4>
    <code><%= am_cert_hash %></code>
</script>

<script type="text/template" id="command-view-template">
    <a class="dropdown-toggle" data-toggle="dropdown">
        <i class="<%= icon_class %>"></i> <%= title %>: <%= selected %> <b class="caret"></b>
    </a>
    <ul class="dropdown-menu">
        <% _.each( options, function( item, index ) { %>
        <li>
            <a name="<%= item.name %>" title="<%= get_description(item) %>"><%= item.name %></a>
        </li>
        <% }) %>
    </ul>
</script>

<script type="text/template" id='drop-down-template'>
    <div class="btn-group">
        <a class="btn btn-primary dropdown-toggle"
           data-toggle="dropdown">
            <i class="<%= icon %>"></i> <%= title %> <span class="caret"></span>
        </a>
        <ul class="dropdown-menu pull-right">
            <% _.each( options, function( item, index ) { %>
            <li>
                <a name="<%= item.name %>" title="<%= get_description(item) %>"><%= item.name %></a>
            </li>
            <% }) %>
        </ul>
    </div>
</script>

<script type="text/template" id="prev-next-template">
    <a title="previous"
       class="btn btn-link prev"
       style="text-decoration: none; padding: 0">
        <i class="icon-arrow-up icon-2x"></i>
    </a>
    <a title="next"
       class="btn btn-link next"
       style="text-decoration: none; padding: 0">
        <i class="icon-arrow-down icon-2x"></i>
    </a>
</script>

<script type="text/template" id="host-template">
    <div class="row-fluid">
        <div class="span4">
            <%= cluster.engagement.client.name %> (<%= cluster.name %>) : <%= domain %> / <%= hostname %>
        </div>
        <div class="span2">
            <%= time_formatted %>
        </div>
        <div class="span1">
            <span class="label label-<%= time_label %>"><%= time_caption %></span>
        </div>
    </div>
    <div class="row-fluid">
        <div class="span2">
            <span style="font-family: courier"><%= ip %></span>
        </div>
        <div class="span3">
            <%= product_name %> <%= os_patch_level %>
        </div>
        <div class="span1">
            <%= version %>
        </div>
        <div class="span2">
            <%= cluster.engagement.number %>
        </div>
    </div>
    <div class="row-fluid">
        <div class="span7">
            <div class="row-fluid">
                <div class="span2">
                    NotReviewed: <%= counts.notreviewed %>
                </div>
                <div class="span2">
                    Investigating: <%= counts.investigating %>
                </div>
                <div class="span2">
                    Escalate: <%= counts.escalate %>
                </div>
                <div class="span2">
                    NotReported: <%= counts.unreported %>
                </div>
                <div class="span2">
                    Reported: <%= counts.reported %>
                </div>
                <div class="span2">
                    Delete: <%= counts.delete %>
                </div>
            </div>
        </div>
    </div>
</script>

<script type="text/template" id="host-condensed-template">
    <table class="table table-condensed table-bordered" style="width: 350px">
        <tr>
            <td>
                <div class="container-fluid">
                    <div class="row-fluid">
                        <div class="span12">
                            <span style="font-weight: bold">
                                <%= cluster.engagement.client.name %> (<%= cluster.name %>)
                            </span>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <div class="span12">
                            <span style="font-weight: bold">
                                <%= domain %> / <%= hostname %>
                            </span>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <div class="span6">
                            <%= time_formatted %>
                        </div>
                        <div class="span6">
                            <span class="label label-<%= time_label %> pull-right"><%= time_caption %></span>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <div class="span12">
                            <%= product_name %> <%= os_patch_level %>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <div class="span12">
                            <%= ip %>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <div class="span6">
                            <%= cluster.engagement.number %>
                        </div>
                        <div class="span6">
                            <%= version %>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <div class="span4">
                            NotReviewed: <%= counts.notreviewed %>
                        </div>
                        <div class="span4">
                            Investigating: <%= counts.investigating %>
                        </div>
                        <div class="span4">
                            Escalate: <%= counts.escalate %>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <div class="span4">
                            NotReported: <%= counts.unreported %>
                        </div>
                        <div class="span4">
                            Reported: <%= counts.reported %>
                        </div>
                        <div class="span4">
                            Delete: <%= counts.delete %>
                        </div>
                    </div>
                </div>
            </td>
        <tr>
    </table>
</script>

<script id="loading-template" type="text/template">
    <table class="" style="width: <%= width %>%; height: <%= height %>">
        <tr>
            <td style="text-align: center; vertical-align: middle">
                <img src="/static/img/ajax-loader.gif">
            </td>
        </tr>
    </table>
</script>

<script id="acquisition-audit-template" type="text/template">
    <div id="acqusition-audit-div" class="modal hide fade" style="overflow: auto" tabindex='-1'>
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
            <h3>
                <icon class="icon-tags"></icon>
                FileItem
            </h3>
        </div>
        <div class="modal-body" style="max-height: 600px; overflow: auto">
            <%= content %>
        </div>
        <div class="modal-footer">
            <a id="close" class="btn btn-primary">
                <icon class="icon-remove-sign"></icon>
                Close
            </a>
        </div>
    </div>
</script>
