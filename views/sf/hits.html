{% extends "/sf/base.html" %}

{% block title %}Hit Review - {{ super() }}{% endblock %}

{% block head %}
    {{ super() }}

    {% include "/sf/templates.html" %}

<style>
    /* Override the default dialog position so that it is not in front of the file/info view. */
    .modal, .modal.fade.in {
        top: 20%;
        left: 30%;
    }
</style>

<script text="text/javascript">
    StrikeFinder.tags = {{ tags }};
    StrikeFinder.usersettings = {{ usersettings }};

    $(document).ready(function () {
        // Initialize routing.
        var HitsRouter = Backbone.Router.extend({
            routes: {
                "services/:services/clusters/:clusters/expkey/:expkey/checkout/:checkout": "init_by_expkey",
                "services/:services/clusters/:clusters/iocnamehash/:iocnamehash/checkout/:checkout": "init_by_iocnamehash",
                "*actions": "default"
            },
            default: function () {
                log.debug('Initializing hits view with defaults');
                // The default route.
                var router = this;
                router.hits_view = new StrikeFinder.HitsView();
                router.hits_view.fetch({
                    checkout: false
                });
            },
            init_by_expkey: function (services, clusters, expkey, checkout) {
                log.debug(_.sprintf('Initializing hits view with expkey: %s', expkey));
                var router = this;
                router.hits_view = new StrikeFinder.HitsView();
                router.hits_view.fetch({
                    services: services,
                    clusters: clusters,
                    expkey: expkey,
                    checkout: checkout});
            },
            init_by_iocnamehash: function (services, clusters, iocnamehash, checkout) {
                log.debug(_.sprintf('Initializing hits view with iocnamehash: %s', iocnamehash));
                var router = this;
                router.hits_view = new StrikeFinder.HitsView();
                router.hits_view.fetch({
                    services: services,
                    clusters: clusters,
                    iocnamehash: iocnamehash,
                    checkout: checkout});
            }
        });
        // Create the main router instance.
        var hits_router = new HitsRouter();
        Backbone.history.start();
    });
</script>
{% endblock %}

{% block content %}
<div class="container-fluid">
    <div class="row-fluid">
        <div class="span12">

            <div class="span6">
                <div class="row-fluid">
                    <div id="hits-div">
                        <table id="hits-table"
                               class="table table-striped table-bordered table-hover table-condensed">
                        </table>
                    </div>
                </div>

                <div class="row-fluid sf-details-view">
                    <div id="iocs-div"></div>
                </div>
            </div>

            <div class="span6">
                <div class="row-fluid">
                    <table id="suppressions-table"
                           class="table table-striped table-bordered table-hover table-condensed">
                    </table>
                </div>

                <div class="row-fluid" style="margin-bottom: 10px">
                    <table>
                        <tr>
                            <td class="sf-details-view" style="vertical-align: top">
                                <div id="prev-next-div" class="pull-left" style="width:100%"></div>
                            </td>
                            <td style="width: 95%">
                                <div id="agent-host-div" class="sf-details-view" style="width: 100%"></div>
                            </td>
                            <td class="sf-details-view" style="text-align: right; vertical-align: top">
                                <div id="tags-div"></div>
                            </td>
                        </tr>
                    </table>
                </div>

                <div class="row-fluid sf-details-view">
                    <div class="span12">
                        <div id="audit-div" style="width: 100%"></div>
                    </div>
                </div>

                <div class="row-fluid sf-details-view">
                    <div class="span12">
                        <div id="comments-div" style="width: 100%">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row-fluid">
            <div class="span12">
                <br/>
            </div>
        </div>
    </div>
</div>
{% endblock %}
